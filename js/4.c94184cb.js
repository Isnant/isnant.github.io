(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"0460":function(e,t,a){},"3a5f":function(e,t,a){"use strict";var i=a("8380");t["a"]={methods:{showLoading:function(){this.$q.loading.show({spinner:i["a"],spinnerColor:"orange-10",spinnerSize:140,backgroundColor:"purple",messageColor:"black"})},showCheckingLoading:function(){this.$q.loading.show({spinner:i["a"],message:"Checking Excel Data...",spinnerColor:"orange-10",spinnerSize:60,backgroundColor:"purple",messageColor:"white",messageSize:60})},showUploadLoading:function(){this.$q.loading.show({spinner:i["a"],message:"Uploading Excel Data...",spinnerColor:"orange-10",spinnerSize:60,backgroundColor:"purple",messageColor:"white",messageSize:60})}}}},4538:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[a("font",{staticClass:"text-bold",attrs:{size:"1",color:"grey"}},[e._v("EQUIPMENT "),a("q-icon",{attrs:{name:"double_arrow"}}),e._v(" FIELD HIERARCHY")],1),a("div",{staticStyle:{"margin-bottom":"30px",width:"200px"},attrs:{align:"left"}},[a("font",{staticClass:"text-bold",staticStyle:{"margin-bottom":"10px"},attrs:{size:"5"}},[e._v("FIELD HIERARCHY")]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-20",staticStyle:{width:"32%"}},[a("q-separator",{attrs:{color:"orange-10"}}),a("q-separator",{attrs:{color:"orange-10"}})],1),a("div",{staticClass:"col"},[a("q-separator",{attrs:{color:"purple-10"}}),a("q-separator",{attrs:{color:"purple-10"}})],1)])],1),a("q-card",[a("q-card-section",[a("q-expansion-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"SEARCH","header-class":"bg-indigo-2 text-indigo-10",icon:"search"}},[a("div",{staticClass:"bg-orange-1",staticStyle:{padding:"10px",width:"100%"}},[a("div",{staticClass:"row",staticStyle:{"margin-bottom":"20px"}},[a("div",{staticClass:"col",staticStyle:{"margin-right":"10px"}},[a("q-input",{staticClass:"searchform",attrs:{"stack-label":"",rounded:"",outlined:"",color:"orange-8",label:"Equipment Id"},model:{value:e.searchVal.equipmentId,callback:function(t){e.$set(e.searchVal,"equipmentId",t)},expression:"searchVal.equipmentId"}})],1),a("div",{staticClass:"col",staticStyle:{"margin-right":"10px"}},[a("q-input",{staticClass:"searchform",attrs:{"stack-label":"",rounded:"",outlined:"",color:"orange-8",label:"Equipment Name"},model:{value:e.searchVal.equipmentName,callback:function(t){e.$set(e.searchVal,"equipmentName",t)},expression:"searchVal.equipmentName"}})],1),a("div",{staticClass:"col",staticStyle:{"margin-right":"10px"}},[a("q-input",{staticClass:"searchform",attrs:{"stack-label":"",rounded:"",outlined:"",color:"orange-8",label:"Equipment Parent"},model:{value:e.searchVal.equipmentParent,callback:function(t){e.$set(e.searchVal,"equipmentParent",t)},expression:"searchVal.equipmentParent"}})],1),a("div",{staticClass:"col",staticStyle:{"margin-right":"10px"}},[a("q-select",{staticClass:"searchform",attrs:{label:"Product Type",rounded:"",outlined:"","stack-label":"",color:"orange-8",options:e.productTypeListSearch},on:{input:function(t){return e.getDropdownValue("productTypeSearch")}},model:{value:e.searchVal.productType,callback:function(t){e.$set(e.searchVal,"productType",t)},expression:"searchVal.productType"}})],1),a("div",{staticClass:"col"},[a("q-btn",{attrs:{round:"",color:"indigo-10"},on:{click:function(t){return e.doSearchByFilter()}}},[a("q-icon",{attrs:{name:"search"}}),a("q-tooltip",[e._v("Search")])],1)],1),a("div",{staticClass:"col-20",staticStyle:{width:"8%"},attrs:{align:"left"}},[a("q-select",{attrs:{"stack-label":"",options:e.statusList,label:"Status"},on:{input:function(t){return e.doSearchByFilter()}},model:{value:e.searchVal.status,callback:function(t){e.$set(e.searchVal,"status",t)},expression:"searchVal.status"}})],1)])])]),a("div",[a("q-table",{attrs:{data:e.dataList,columns:e.tableColumns,pagination:e.pagination,"table-header-class":"text-indigo-10 bg-indigo-2","row-key":"id",dense:""},on:{"update:pagination":function(t){e.pagination=t},request:e.doMainEquipmentChangePage},scopedSlots:e._u([{key:"body-cell-historyDate",fn:function(t){return a("q-td",{},[e._v("\n            "+e._s(e._f("formatDate")(t.row.historyDate))+"\n          ")])}},{key:"body-cell-action",fn:function(t){return a("q-td",{},[a("div",{attrs:{align:"center"}},[a("q-btn-dropdown",{attrs:{rounded:"",size:"sm",color:"indigo-10"}},[a("q-list",[a("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""}},[a("q-item-section",[a("q-btn",{attrs:{color:"indigo-6",round:"",size:"sm"},on:{click:function(a){return e.doOpenForm(t.row)}}},[a("q-icon",{attrs:{name:"fas fa-edit"}}),a("q-tooltip",[e._v("Show Child")])],1)],1)],1),a("q-item",[a("q-item-section",[a("q-btn",{attrs:{color:"indigo-6",round:"",size:"sm"},nativeOn:{click:function(a){return e.history(t)}}},[a("q-icon",{attrs:{name:"history",color:"white"}}),a("q-tooltip",[e._v("History")])],1)],1)],1)],1)],1)],1)])}},{key:"body-cell-recordStatus",fn:function(e){return a("q-td",{},["A"===e.row.recordStatus?a("div",[a("q-icon",{staticStyle:{"font-size":"20px"},attrs:{name:"done",color:"primary"}})],1):a("div",[a("q-icon",{staticStyle:{"font-size":"20px"},attrs:{name:"clear",color:"negative"}})],1)])}}])})],1)],1)],1),a("q-dialog",{attrs:{persistent:""},model:{value:e.showForm,callback:function(t){e.showForm=t},expression:"showForm"}},[a("q-card",{staticClass:"bg-white"},[a("q-bar",{staticClass:"bg-indigo-10 text-white"},[a("strong",[e._v("Detail Hierarchy")]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1),a("q-card",[a("q-card-section",[a("q-tree",{ref:"sourcePreview",attrs:{nodes:e.sourcePreview,"node-key":"label","default-expand-all":""},scopedSlots:e._u([{key:"default-header",fn:function(t){return[a("span",{staticClass:"text-weight-bold text-green"},[e._v(e._s(t.node.label))])]}}])})],1)],1)],1)],1),a("q-dialog",{attrs:{persistent:""},on:{"before-hide":function(t){return e.clear()}},model:{value:e.historyHierarchyForm,callback:function(t){e.historyHierarchyForm=t},expression:"historyHierarchyForm"}},[a("q-card",{staticClass:"bg-white",staticStyle:{width:"300px","max-width":"80vw"}},[a("q-bar",{staticClass:"bg-indigo-10 text-white"},[a("strong",[e._v("History Hierarchy")]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1),a("q-card-section",{staticStyle:{"max-height":"50vh"}},[a("div",{attrs:{align:"center"}},[a("br"),a("font",{staticClass:"text-bold",attrs:{size:"2"}},[e._v("Created:")]),a("br"),a("font",{attrs:{size:"2"}},[e._v(e._s(e.input.createdBy||"-"))]),a("br"),a("font",{attrs:{size:"2"}},[e._v(e._s(e.input.createdDate))]),a("br"),a("br"),a("font",{staticClass:"text-bold",attrs:{size:"2"}},[e._v("Modified:")]),a("br"),a("font",{attrs:{size:"2"}},[e._v(e._s(e.input.modifiedBy||"-"))]),a("br"),a("font",{attrs:{size:"2"}},[e._v(e._s(e.input.lastModified))])],1)])],1)],1)],1)},s=[],r=(a("20d6"),a("28a5"),a("3a5f")),n=a("c1df"),o=a.n(n),l={mixins:[r["a"]],data:function(){return{dataList:[],areaList:[],sourcePreview:[],statusList:["All","Active","Inactive"],filteredRegionList:[],listOfRegion:[],listOfAreaForRegion:[],productTypeListSearch:[],historyHierarchyForm:!1,input:"",tableColumns:[{name:"productType",label:"Product Type",field:"productType",align:"left",style:"width: 100px",sortable:!0},{name:"equipmentId",label:"Equipment Id",field:"equipmentId",align:"left",style:"width: 200px",sortable:!0},{name:"equipmentName",label:"Equipment Name",field:"equipmentName",align:"left",style:"width: 200px",sortable:!0},{name:"parentId",label:"Parent Id",field:"parentId",align:"left",sortable:!0},{name:"parentName",label:"Parent Name",field:"parentName",align:"left",style:"width: 200px",sortable:!0},{name:"recordStatus",label:"Status",field:"recordStatus",align:"left",sortable:!0},{name:"action",label:"Action",align:"center"}],pagination:{sortBy:"id",descending:!0,page:1,rowsPerPage:10,rowsNumber:0},regionPagination:{sortBy:"region",descending:!1,rowsPerPage:0},searchVal:{equipmentId:"",equipmentName:"",equipmentParent:"",status:"Active",productType:"ALL"},showForm:!1,formData:{pid:"",fidRegion:"",buildingType:"",buildingName:"",itCode:"",area:"",region:"",city:"",locationName:"",complexName:"",streetName:"",streetNumber:"",postalCode:"",phone:"",fax:""}}},methods:{doInitPage:function(){var e=this;this.showLoading();var t=localStorage.getItem("user-token"),a=JSON.parse(atob(t.split(".")[1])).authorities;-1===a.findIndex((function(e){return"ROLE_07"===e}))&&this.$router.push("/"),this.$axios.get("".concat("/","getHierarchyInitData"),{params:{pageIndex:this.pagination.page-1,pageSize:this.pagination.rowsPerPage,sortBy:this.pagination.sortBy,descending:this.pagination.descending,equipmentName:this.searchVal.equipmentName,equipmentParent:this.searchVal.equipmentParent,status:this.searchVal.status,equipmentId:this.searchVal.equipmentId,productType:this.searchVal.productType}}).then((function(t){e.$q.loading.hide(),e.doMainFillTableResult(t.data.listOfHierarchy),e.productTypeListSearch=t.data.listOfProductTypeSearch.filter((function(e){return"Field"===e.cascadeValue})),e.productTypeListSearch.unshift({label:"ALL",value:"ALL"})})).catch((function(t){e.$q.loading.hide(),e.$q.notify({color:"negative",icon:"report_problem",message:t})}))},getHierarchyList:function(e){var t=this;this.showLoading(),this.$axios.get("".concat("/","getHierarchyList"),{params:e}).then((function(e){t.$q.loading.hide(),t.doMainFillTableResult(e.data)})).catch((function(e){t.$q.loading.hide(),t.$q.notify({color:"negative",icon:"report_problem",message:e})}))},doMainFillTableResult:function(e){this.dataList=e.content,this.pagination.rowsNumber=e.totalElements,this.pagination.rowsPerPage=e.pageable.pageSize,this.pagination.page=e.number+1},doMainEquipmentChangePage:function(e){var t=e.pagination,a=t.page,i=t.rowsPerPage,s=t.sortBy,r=t.descending,n={pageIndex:a-1,pageSize:i,sortBy:s,descending:r,equipmentName:this.searchVal.equipmentName,equipmentParent:this.searchVal.equipmentParent,status:this.searchVal.status,equipmentId:this.searchVal.equipmentId,productType:this.searchVal.productType};this.getHierarchyList(n)},doSearchByFilter:function(){var e={pageIndex:this.pagination.page-1,pageSize:this.pagination.rowsPerPage,sortBy:this.pagination.sortBy,descending:this.pagination.descending,equipmentName:this.searchVal.equipmentName,equipmentParent:this.searchVal.equipmentParent,status:this.searchVal.status,equipmentId:this.searchVal.equipmentId,productType:this.searchVal.productType};this.getHierarchyList(e)},doClearSearchVal:function(e){"start"===e?null===this.searchVal.reqStartDate&&(this.searchVal.reqStartDate=""):null===this.searchVal.reqEndDate&&(this.searchVal.reqEndDate=""),this.doSearchByFilter()},getDropdownValue:function(e){"productTypeSearch"===e&&(this.searchVal.productType=this.searchVal.productType.value)},doOpenForm:function(e){var t=this;this.showLoading(),this.$axios.get("".concat("/","getHierarchyByParent"),{params:{equipmentName:e.equipmentName}}).then((function(a){t.$q.loading.hide(),t.setTreeHierarchy(a.data,e)})).catch((function(e){t.$q.loading.hide(),t.$q.notify({color:"negative",icon:"report_problem",message:e})}))},setTreeHierarchy:function(e,t){var a={label:t.equipmentName+"-"+t.equipmentId+" - ["+t.productType+"]",header:"root",children:[]},i=this.getMigrationPreviewChild(e,t.equipmentName);a.children=i,this.showForm=!0,this.$set(this.sourcePreview,0,a)},getMigrationPreviewChild:function(e,t){for(var a=e.filter((function(e){return e.parentName===t})),i=[],s=0;s<a.length;s++){var r={label:a[s].equipmentName+" - "+a[s].equipmentId+" - ["+a[s].productType+"]",children:[]};r.children=this.getMigrationPreviewChild(e,a[s].equipmentName),i.push(r)}return i},history:function(e){void 0!==e?(this.input=JSON.parse(JSON.stringify(e.row)),this.input.createdDate=o()(this.input.createdDate).format("DD/MM/YYYY HH:mm"),this.input.lastModified=o()(this.input.lastModified).format("DD/MM/YYYY HH:mm")):this.clear(),this.historyHierarchyForm=!0}},beforeMount:function(){this.doInitPage()}},c=l,d=(a("ae5a"),a("2877")),p=Object(d["a"])(c,i,s,!1,null,null,null);t["default"]=p.exports},ae5a:function(e,t,a){"use strict";var i=a("0460"),s=a.n(i);s.a}}]);