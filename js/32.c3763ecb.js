(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[32],{b8d1:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"margin-left":"10px","margin-right":"10px","margin-bottom":"10px","margin-top":"2px"},attrs:{id:"main"}},[a("font",{staticClass:"text-bold",attrs:{size:"1",color:"grey"}},[t._v("SECURITY / USER LIST")]),a("div",{staticStyle:{"margin-bottom":"30px","margin-top":"20px",width:"120px"},attrs:{align:"left"}},[a("font",{staticClass:"text-bold",staticStyle:{"margin-bottom":"10px"},attrs:{size:"5"}},[t._v("USER LIST")]),a("q-separator",{attrs:{color:"purple-10"}}),a("q-separator",{attrs:{color:"purple-10"}})],1),a("div",{staticClass:"row",staticStyle:{width:"70%","margin-bottom":"20px"}},[a("div",{staticClass:"col",staticStyle:{"margin-right":"10px"},attrs:{align:"right"}},[a("q-input",{attrs:{color:"indigo-8",label:"Username","stack-label":!0},model:{value:t.formSearch.username,callback:function(e){t.$set(t.formSearch,"username",e)},expression:"formSearch.username"}})],1),a("div",{staticClass:"col",staticStyle:{"margin-right":"10px"}},[a("q-btn",{staticStyle:{"margin-top":"20px"},attrs:{size:"sm",round:"",color:"indigo-8"},on:{click:function(e){return t.getContent(t.t)}}},[a("q-icon",{attrs:{name:"search"}},[a("q-tooltip",[t._v("Search")])],1)],1)],1)]),a("q-table",{staticStyle:{"margin-bottom":"100px"},attrs:{data:t.dataList,columns:t.columns,pagination:t.pagination,"row-key":"id","table-header-class":"text-white bg-indigo-8",dense:""},on:{"update:pagination":function(e){t.pagination=e},request:t.getContent},scopedSlots:t._u([{key:"body-cell-createdDate",fn:function(e){return a("q-td",{},[t._v("\n       "+t._s(t._f("formatDateTime")(e.row.createdDate))+"\n     ")])}},{key:"body-cell-department",fn:function(e){return a("q-td",{},[t._v("\n       "+t._s(e.row.department||"---")+"\n     ")])}},{key:"body-cell-roleNames",fn:function(e){return a("q-td",{},[a("q-option-group",{attrs:{options:t.roles,label:"Roles",type:"checkbox",disable:"",dense:""},model:{value:e.row.roleNames,callback:function(a){t.$set(e.row,"roleNames",a)},expression:"props.row.roleNames"}})],1)}},{key:"body-cell-recordStatus",fn:function(t){return a("q-td",{attrs:{align:"center"}},["A"===t.row.recordStatus?a("div",[a("q-icon",{staticStyle:{"font-size":"20px"},attrs:{name:"done",color:"primary"}})],1):a("div",[a("q-icon",{staticStyle:{"font-size":"20px"},attrs:{name:"clear",color:"negative"}})],1)])}},{key:"body-cell-action",fn:function(e){return a("q-td",{attrs:{align:"center"}},[a("q-btn-dropdown",{attrs:{rounded:"",size:"sm",color:"indigo-10"}},[a("q-list",[a("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""}},[a("q-item-section",[a("q-btn",{attrs:{color:"indigo-6",round:"",size:"sm"},nativeOn:{click:function(a){return t.showForm(e.row.username)}}},[a("q-icon",{attrs:{name:"fas fa-edit"}}),a("q-tooltip",[t._v("Edit")])],1)],1)],1),a("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""}},[a("q-item-section",[a("q-btn",{attrs:{color:"indigo-6",round:"",size:"sm"},on:{click:function(a){return t.doToggleStatus(e)}}},[a("q-icon",{attrs:{name:"A"===e.row.recordStatus?"fas fa-stop-circle":"fas fa-play-circle"}}),a("q-tooltip",[t._v(t._s("A"===e.row.recordStatus?"Deactivate":"Activate"))])],1)],1)],1)],1)],1)],1)}}])}),a("div",[a("q-btn",{attrs:{icon:"add",round:"",color:"orange-5"},on:{click:function(e){return t.syncCrm()}}},[a("q-tooltip",[t._v("Sync CRM")])],1)],1),a("q-page-sticky",{attrs:{position:"top-right",offset:[30,30]}},[a("q-btn",{attrs:{icon:"add",round:"",color:"orange-5"},on:{click:function(e){return t.showForm()}}},[a("q-tooltip",[t._v("Add New")])],1)],1),a("q-dialog",{attrs:{persistent:""},on:{"before-hide":function(e){return t.doBeforeFormClose()}},model:{value:t.isFormVisible,callback:function(e){t.isFormVisible=e},expression:"isFormVisible"}},[a("q-card",{staticClass:"bg-white",staticStyle:{width:"400px"}},[a("q-bar",{staticClass:"bg-primary text-white"},[a("strong",[t._v("User Form")]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1),a("q-card-section",[a("q-input",{staticClass:"q-pr-sm",attrs:{"stack-label":"",label:"User Name",readonly:void 0!==t.instance.createdBy},model:{value:t.instance.username,callback:function(e){t.$set(t.instance,"username",e)},expression:"instance.username"}}),a("q-select",{staticClass:"q-pr-sm",attrs:{"stack-label":"",label:"Department",options:t.departmentList},on:{input:function(e){return t.getSelectValue()}},model:{value:t.instance.branch,callback:function(e){t.$set(t.instance,"branch",e)},expression:"instance.branch"}}),a("q-input",{staticClass:"q-pr-sm",attrs:{"stack-label":"",label:"Full Name"},model:{value:t.instance.fullName,callback:function(e){t.$set(t.instance,"fullName",e)},expression:"instance.fullName"}}),a("q-input",{staticClass:"q-pr-sm",attrs:{"stack-label":"",label:"Email"},model:{value:t.instance.email,callback:function(e){t.$set(t.instance,"email",e)},expression:"instance.email"}}),a("br"),a("q-option-group",{attrs:{options:t.roles,label:"Roles",type:"checkbox",dense:""},on:{input:t.doRoles},model:{value:t.instance.roles,callback:function(e){t.$set(t.instance,"roles",e)},expression:"instance.roles"}}),a("div",{attrs:{align:"right"}},[a("q-btn",{attrs:{round:"",icon:"save",size:"md",color:"orange-5"},on:{click:function(e){return t.doSave()}}},[a("q-tooltip",[t._v("Sumbit")])],1)],1)],1)],1)],1)],1)},i=[],s=(a("28a5"),a("55dd"),{beforeMount:function(){this.getInitPage()},data:function(){return{dataList:[],departmentList:[],columns:[{name:"username",label:"User Name",field:"username",align:"left",sortable:!0},{name:"fullName",label:"Full Name",field:"fullName",align:"left",sortable:!0},{name:"roleNames",label:"Roles",field:"roleNames",align:"left",sortable:!0},{name:"branch",label:"Department",field:"branch",align:"left",sortable:!0},{name:"createdDate",label:"Created Date",field:"createdDate",align:"left",sortable:!0},{name:"recordStatus",label:"Status",field:"recordStatus",align:"left",sortable:!0},{name:"action",label:"Action",field:"action",align:"center",sortable:!0}],pagination:{sortBy:"fullName",descending:!1,page:1,rowsPerPage:20,rowsNumber:0},formSearch:{username:"",branch:"All",roles:"All",roless:"All"},isFormVisible:!1,instance:{username:"",fidManager:"",fullName:"",email:"",department:"",branch:"",roles:[]},roles:[],rolesList:[],branch:[],branchList:[],branchesRequestor:[],branchesInspector:[],branchesHPA:[],branchesTMSales:[],filteredBranchList:[],branchSelect:!0}},methods:{getInitPage:function(){var t=this;this.$q.loading.show();var e=localStorage.getItem("user-token");void 0!==e&&null!==e||(this.$q.loading.hide(),this.$router.push("/login")),this.$axios.get("".concat("/","getUserListInitData"),{params:{pageIndex:this.pagination.page-1,pageSize:this.pagination.rowsPerPage,sortBy:this.pagination.sortBy,descending:this.pagination.descending}}).then((function(e){t.$q.loading.hide(),t.dataList=e.data.listOfUser.content,t.pagination.rowsNumber=e.data.listOfUser.totalElements,t.pagination.page=e.data.listOfUser.number+1,t.departmentList=e.data.listOfDepartment,t.departmentList.sort(t.compare),t.roles=e.data.listOfRole,t.rolesList=t.roles,t.rolesList.sort(t.compare),t.dataList.forEach((function(e,a){t.dataList[a].roleNames=t.dataList[a].roles.substr(1,t.dataList[a].roles.length-2).split(";")}))})).catch((function(e){t.$q.loading.hide(),t.$q.notify({color:"negative",icon:"report_problem",message:e})}))},getContent:function(t){var e=this;this.$q.loading.show();var a="",n="",i="",s="";"undefined"===typeof t?(a=this.pagination.page-1,n=this.pagination.rowsPerPage,i=this.pagination.sortBy,s=this.pagination.descending):(a=t.pagination.page-1,n=t.pagination.rowsPerPage,i=t.pagination.sortBy,s=t.pagination.descending,this.pagination.sortBy=t.pagination.sortBy,this.pagination.descending=t.pagination.descending),this.$axios.get("".concat("/","getListOfUser"),{params:{pageIndex:a,pageSize:n,sortBy:i,descending:s,username:this.formSearch.username,branch:this.formSearch.branch,roles:this.formSearch.roless}}).then((function(t){e.$q.loading.hide(),e.dataList=t.data.content,e.pagination.rowsNumber=t.data.totalElements,e.pagination.page=t.data.number+1,e.pagination.rowsPerPage=t.data.pageable.pageSize})).catch((function(t){e.$q.loading.hide(),e.$q.notify({color:"negative",icon:"report_problem",message:t})}))},showForm:function(t){var e=this;this.$q.loading.show(),void 0!==t?this.$axios.get("".concat("/","getUserForm"),{params:{id:t}}).then((function(t){e.$q.loading.hide(),e.instance=t.data,e.instance.roles=e.instance.roles.substr(1,e.instance.roles.length-2).split(";"),e.isFormVisible=!0})).catch((function(t){e.$q.loading.hide(),e.$q.notify({color:"negative",icon:"report_problem",message:t})})):(this.$q.loading.hide(),this.isFormVisible=!0)},constructBranchList:function(t){for(var e=[],a=0;a<t.length;a++)e.push(t[a].value);this.filteredBranchList=e},getSelectValue:function(){this.instance.branch=this.instance.branch.value},syncCrm:function(){var t=this;this.$q.loading.show(),this.$axios.get("".concat("/","syncEquipmentToCrm")).then((function(e){t.$q.loading.hide()})).catch((function(e){t.$q.loading.hide(),t.$q.notify({color:"negative",icon:"report_problem",message:e})}))},doBeforeFormClose:function(){void 0!==this.instance&&(delete this.instance.username,this.instance.fullName="",this.instance.fidManager="",this.instance.email="",this.instance.department="",this.instance.branch=[],this.instance.roles=[],this.instance.createdDate=void 0,this.instance.createdBy=void 0,this.lastModified=void 0,this.modifiedBy=void 0,this.recordStatus=void 0,this.branchSelect=!0,this.branch=[])},doSave:function(){var t=this;if(this.$q.loading.show(),0===this.instance.roles.length)return this.$q.notify({color:"negative",icon:"report_problem",message:"Rights is required. Please assign at least one rights."}),void this.$q.loading.hide();this.instance.roles=";"+this.instance.roles.join(";")+";",this.$axios.post("".concat("/","doSaveUser"),this.instance).then((function(e){t.$q.loading.hide(),t.$q.notify({color:"positive",icon:"done",message:"User "+t.instance.username+" saved"}),t.doBeforeFormClose(),t.isFormVisible=!1,t.getContent()})).catch((function(e){t.$q.loading.hide(),t.$q.notify({color:"negative",icon:"report_problem",message:e})}))},doToggleStatus:function(t){var e=this;t.row.recordStatus="I"===t.row.recordStatus?"A":"I",this.instance=t.row,this.instance.roleNames=null,this.$axios.post("".concat("/","doSaveUser"),this.instance).then((function(t){e.$q.loading.hide(),e.$q.notify({color:"positive",icon:"done",message:"User "+e.instance.username+" saved"}),e.doBeforeFormClose(),e.isFormVisible=!1,e.getInitPage()})).catch((function(t){e.$q.loading.hide(),e.$q.notify({color:"negative",icon:"report_problem",message:t})}))},compare:function(t,e){var a=t.label.toUpperCase(),n=e.label.toUpperCase(),i=0;return a>n?i=1:a<n&&(i=-1),i}}}),o=s,r=a("2877"),l=Object(r["a"])(o,n,i,!1,null,null,null);e["default"]=l.exports}}]);